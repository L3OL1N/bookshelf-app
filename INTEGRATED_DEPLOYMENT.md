# å‰å¾Œç«¯æ•´åˆéƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—èªªæ˜å¦‚ä½•å°‡å‰ç«¯å’Œå¾Œç«¯æ•´åˆåœ¨ä¸€èµ·ï¼Œé€šéå–®ä¸€ä¼ºæœå™¨åŒæ™‚æä¾›å‰ç«¯é é¢å’Œ API æœå‹™ã€‚

## ğŸ¯ éƒ¨ç½²æ¨¡å¼æ¯”è¼ƒ

### æ¨¡å¼ 1: å‰å¾Œç«¯æ•´åˆï¼ˆæ¨è–¦ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒï¼‰
- âœ… **å„ªé»**: éƒ¨ç½²ç°¡å–®ã€ä¸éœ€è™•ç† CORSã€ä½¿ç”¨ç›¸å°è·¯å¾‘
- ğŸ“¦ **é©ç”¨**: Heroku, Railway, Render, VPS ç­‰
- ğŸŒ **è¨ªå•**: å–®ä¸€ç¶²å€ï¼ˆå¦‚ `http://localhost:3000`ï¼‰

### æ¨¡å¼ 2: å‰å¾Œç«¯åˆ†é›¢
- âœ… **å„ªé»**: å‰å¾Œç«¯å¯ç¨ç«‹æ“´å±•ã€ä½¿ç”¨ CDN
- ğŸ“¦ **é©ç”¨**: Vercel/Netlify (å‰ç«¯) + Heroku (å¾Œç«¯)
- ğŸŒ **è¨ªå•**: å‰ç«¯å’Œå¾Œç«¯ä½¿ç”¨ä¸åŒç¶²å€

### æ¨¡å¼ 3: é–‹ç™¼æ¨¡å¼
- âœ… **å„ªé»**: å‰å¾Œç«¯å¯ç¨ç«‹é‡å•Ÿã€é–‹ç™¼éˆæ´»
- ğŸ“¦ **é©ç”¨**: æœ¬åœ°é–‹ç™¼
- ğŸŒ **è¨ªå•**: å‰ç«¯ `http://localhost:8080`ï¼Œå¾Œç«¯ `http://localhost:3000`

## ğŸš€ å¿«é€Ÿé–‹å§‹ï¼ˆå‰å¾Œç«¯æ•´åˆï¼‰

### æ–¹æ³• 1: ä¸€éµå•Ÿå‹•ï¼ˆæ¨è–¦ï¼‰

```bash
npm start
```

é€™å€‹æŒ‡ä»¤æœƒï¼š
1. è‡ªå‹•æ‰“åŒ…å‰ç«¯åˆ° `public` è³‡æ–™å¤¾
2. å•Ÿå‹•å¾Œç«¯ä¼ºæœå™¨ï¼ˆåŒæ™‚æä¾›å‰ç«¯å’Œ APIï¼‰
3. è¨ªå• http://localhost:3000

### æ–¹æ³• 2: åˆ†æ­¥åŸ·è¡Œ

```bash
# 1. æ‰“åŒ…å‰ç«¯åˆ° public è³‡æ–™å¤¾
npm run build:public

# 2. å•Ÿå‹•å¾Œç«¯ä¼ºæœå™¨
cd backend
node server.js
```

è¨ªå• http://localhost:3000

## ğŸ“‹ è©³ç´°æ­¥é©Ÿ

### 1. æ‰“åŒ…å‰ç«¯

```bash
npm run build:public
```

é€™æœƒå°‡å‰ç«¯æª”æ¡ˆè¤‡è£½åˆ° `public` è³‡æ–™å¤¾ï¼š
- âœ… index.html
- âœ… app.js
- âœ… config.js
- âœ… style.css

### 2. ç’°å¢ƒè®Šæ•¸è¨­å®šï¼ˆå¯é¸ï¼‰

å»ºç«‹ `backend/.env` æª”æ¡ˆï¼ˆåƒè€ƒ `backend/.env.example`ï¼‰ï¼š

```env
# ä¼ºæœå™¨ç«¯å£
PORT=3000

# åŸ·è¡Œç’°å¢ƒ
NODE_ENV=production

# æ˜¯å¦æä¾›å‰ç«¯éœæ…‹æª”æ¡ˆï¼ˆé è¨­ trueï¼‰
SERVE_FRONTEND=true
```

### 3. å•Ÿå‹•ä¼ºæœå™¨

```bash
cd backend
node server.js
```

ä½ æœƒçœ‹åˆ°ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“š Bookshelf Server                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Environment: production                â”‚
â”‚  Port:        3000                      â”‚
â”‚  Frontend:    Enabled                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ http://localhost:3000               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. è¨ªå•æ‡‰ç”¨ç¨‹å¼

é–‹å•Ÿç€è¦½å™¨è¨ªå• http://localhost:3000

## ğŸ”§ é‹è¡Œæ¨¡å¼èªªæ˜

### æ•´åˆæ¨¡å¼ï¼ˆé è¨­ï¼‰

ç•¶ `SERVE_FRONTEND=true` æˆ–æœªè¨­å®šæ™‚ï¼š

- âœ… `/` â†’ è¿”å›å‰ç«¯ index.html
- âœ… `/api/books` â†’ API ç«¯é»
- âœ… `/style.css` â†’ éœæ…‹æª”æ¡ˆ
- âœ… ä»»ä½•é API è·¯ç”± â†’ è¿”å› index.htmlï¼ˆSPA æ”¯æ´ï¼‰

### API å°ˆç”¨æ¨¡å¼

ç•¶ `SERVE_FRONTEND=false` æ™‚ï¼š

```bash
npm run start:api-only
```

- âœ… `/` â†’ è¿”å› API è³‡è¨Š JSON
- âœ… `/api/books` â†’ API ç«¯é»
- âŒ ä¸æä¾›å‰ç«¯éœæ…‹æª”æ¡ˆ

é©ç”¨æ–¼å‰å¾Œç«¯åˆ†é›¢éƒ¨ç½²æ™‚çš„å¾Œç«¯ã€‚

## ğŸŒ ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

### Heroku éƒ¨ç½²

1. **å»ºç«‹ Procfile**

```
web: cd backend && node server.js
```

2. **å»ºç«‹ heroku-postbuild è…³æœ¬**

åœ¨æ ¹ç›®éŒ„ `package.json` åŠ å…¥ï¼š

```json
{
  "scripts": {
    "heroku-postbuild": "npm run build:public"
  }
}
```

3. **éƒ¨ç½²**

```bash
heroku create your-app-name
git push heroku main
```

### Railway éƒ¨ç½²

1. é€£æ¥ GitHub å€‰åº«
2. è¨­å®šç’°å¢ƒè®Šæ•¸ï¼š
   - `PORT`: è‡ªå‹•è¨­å®š
   - `NODE_ENV`: production
3. è¨­å®šå•Ÿå‹•å‘½ä»¤: `npm start`

### VPS (Ubuntu/Debian) éƒ¨ç½²

```bash
# 1. ä¸Šå‚³å°ˆæ¡ˆåˆ°ä¼ºæœå™¨

# 2. å®‰è£ä¾è³´
cd bookshelf-app
npm install
cd backend && npm install

# 3. æ‰“åŒ…å‰ç«¯
cd ..
npm run build:public

# 4. ä½¿ç”¨ PM2 é‹è¡Œ
npm install -g pm2
cd backend
pm2 start server.js --name bookshelf-app

# 5. è¨­å®š Nginx åå‘ä»£ç†ï¼ˆå¯é¸ï¼‰
# ç·¨è¼¯ /etc/nginx/sites-available/bookshelf
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## ğŸ“ è·¯ç”±å„ªå…ˆé †åº

`server.js` ä¸­çš„è·¯ç”±è™•ç†é †åºï¼š

```javascript
1. API Routes â†’ /api/books/*
2. Static Files â†’ /style.css, /app.js, /config.js
3. SPA Fallback â†’ /* (è¿”å› index.html)
```

é€™ç¢ºä¿äº†ï¼š
- API è«‹æ±‚å„ªå…ˆè™•ç†
- éœæ…‹è³‡æºæ­£ç¢ºè¼‰å…¥
- SPA è·¯ç”±æ­£å¸¸å·¥ä½œ

## ğŸ§ª æ¸¬è©¦éƒ¨ç½²

### æ¸¬è©¦å‰ç«¯

```bash
# è¨ªå•ä¸»é 
curl http://localhost:3000

# æ‡‰è©²è¿”å› HTML å…§å®¹
```

### æ¸¬è©¦ API

```bash
# æ¸¬è©¦ API ç«¯é»
curl http://localhost:3000/api/books

# æ‡‰è©²è¿”å› JSON è³‡æ–™
```

### æ¸¬è©¦éœæ…‹æª”æ¡ˆ

```bash
# æ¸¬è©¦ CSS
curl http://localhost:3000/style.css

# æ‡‰è©²è¿”å› CSS å…§å®¹
```

## ğŸ”„ æ›´æ–°éƒ¨ç½²

ç•¶ä¿®æ”¹å‰ç«¯ä»£ç¢¼å¾Œï¼š

```bash
# 1. é‡æ–°æ‰“åŒ…
npm run build:public

# 2. é‡å•Ÿä¼ºæœå™¨
cd backend
node server.js
```

æˆ–ä½¿ç”¨ PM2ï¼š

```bash
npm run build:public
pm2 restart bookshelf-app
```

## ğŸ¯ é–‹ç™¼å·¥ä½œæµç¨‹

### æ—¥å¸¸é–‹ç™¼ï¼ˆå‰å¾Œç«¯åˆ†é›¢ï¼‰

```bash
npm run dev
```

é€™æœƒåŒæ™‚å•Ÿå‹•ï¼š
- å‰ç«¯: http://localhost:8080
- å¾Œç«¯: http://localhost:3000

å‰ç«¯æœƒè‡ªå‹•ä½¿ç”¨ `http://localhost:3000/api`ï¼ˆåƒè€ƒ `config.js`ï¼‰

### æ¸¬è©¦æ•´åˆéƒ¨ç½²

```bash
npm start
```

æ¸¬è©¦å‰å¾Œç«¯æ•´åˆåœ¨å–®ä¸€ä¼ºæœå™¨ä¸Šæ˜¯å¦æ­£å¸¸é‹ä½œã€‚

## ğŸ“Š éƒ¨ç½²æª¢æŸ¥æ¸…å–®

éƒ¨ç½²å‰ç¢ºèªï¼š

- [ ] åŸ·è¡Œ `npm run build:public` æˆåŠŸ
- [ ] `public` è³‡æ–™å¤¾åŒ…å«æ‰€æœ‰å‰ç«¯æª”æ¡ˆ
- [ ] è¨­å®šç’°å¢ƒè®Šæ•¸ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
- [ ] æ¸¬è©¦ API ç«¯é»æ­£å¸¸é‹ä½œ
- [ ] æ¸¬è©¦å‰ç«¯å¯ä»¥æ­£å¸¸è¨ªå•
- [ ] æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½ï¼ˆæ–°å¢ã€ç·¨è¼¯ã€åˆªé™¤ã€AI åŒ¯å…¥ã€å°é¢æŠ“å–ï¼‰
- [ ] ç¢ºèªè³‡æ–™åº«æª”æ¡ˆè·¯å¾‘æ­£ç¢º
- [ ] è¨­å®šç”Ÿç”¢ç’°å¢ƒçš„éŒ¯èª¤è™•ç†

## âš ï¸ å¸¸è¦‹å•é¡Œ

### Q1: å‰ç«¯ç„¡æ³•è¼‰å…¥

**æª¢æŸ¥**:
- ç¢ºèªå·²åŸ·è¡Œ `npm run build:public`
- ç¢ºèª `SERVE_FRONTEND` ä¸æ˜¯ `false`
- æª¢æŸ¥ `public` è³‡æ–™å¤¾æ˜¯å¦å­˜åœ¨ä¸”æœ‰æª”æ¡ˆ

### Q2: API 404 éŒ¯èª¤

**æª¢æŸ¥**:
- ç¢ºèª API è·¯ç”±ä»¥ `/api` é–‹é ­
- æª¢æŸ¥å¾Œç«¯æ—¥èªŒæ˜¯å¦æœ‰éŒ¯èª¤

### Q3: éœæ…‹æª”æ¡ˆ 404

**æª¢æŸ¥**:
- ç¢ºèªæª”æ¡ˆåœ¨ `public` è³‡æ–™å¤¾ä¸­
- æª¢æŸ¥æª”æ¡ˆåç¨±å¤§å°å¯«æ˜¯å¦æ­£ç¢º

### Q4: åˆ·æ–°é é¢å‡ºç¾ 404

é€™æ˜¯æ­£å¸¸çš„ï¼å› ç‚º `server.js` æœƒå°‡æ‰€æœ‰é API è·¯ç”±è¿”å› `index.html`ï¼Œæ”¯æ´ SPA è·¯ç”±ã€‚

å¦‚æœä»ç„¶å‡ºç¾ 404ï¼Œæª¢æŸ¥ `server.js` ä¸­çš„ SPA fallback é‚è¼¯ã€‚

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [BUILD.md](BUILD.md) - å‰ç«¯æ‰“åŒ…è©³ç´°èªªæ˜
- [DEPLOYMENT_QUICK_START.md](DEPLOYMENT_QUICK_START.md) - å¿«é€Ÿéƒ¨ç½²æŒ‡å—
- [backend/.env.example](backend/.env.example) - ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
